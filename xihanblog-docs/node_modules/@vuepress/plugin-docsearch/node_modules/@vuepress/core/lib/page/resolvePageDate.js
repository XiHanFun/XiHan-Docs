"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.resolvePageDate = void 0;
const shared_1 = require("@vuepress/shared");
const utils_1 = require("@vuepress/utils");
const FILENAME_DATE_RE = /(\d{4}-\d{1,2}(-\d{1,2})?)-(.*)/;
const defaultDate = '1970-01-01';
/**
 * Resolve page date according to frontmatter or file path
 *
 * It will be resolved as 'yyyy-MM-dd' format
 */
const resolvePageDate = ({ frontmatter, filePathRelative, }) => {
    // `frontmatter.date` could be parsed as UTC Date directly
    if (frontmatter.date instanceof Date) {
        return shared_1.formatDateString([
            frontmatter.date.getUTCFullYear(),
            frontmatter.date.getUTCMonth() + 1,
            frontmatter.date.getUTCDate(),
        ].join('-'), defaultDate);
    }
    if (shared_1.isString(frontmatter.date)) {
        return shared_1.formatDateString(frontmatter.date, defaultDate);
    }
    if (filePathRelative === null) {
        return defaultDate;
    }
    const filename = utils_1.path.parse(filePathRelative).name;
    if (filename) {
        const matches = filename.match(FILENAME_DATE_RE);
        if (matches) {
            return shared_1.formatDateString(matches[1], defaultDate);
        }
    }
    const dirname = utils_1.path.basename(utils_1.path.dirname(filePathRelative));
    if (dirname) {
        const matches = dirname.match(FILENAME_DATE_RE);
        if (matches) {
            return shared_1.formatDateString(matches[1], defaultDate);
        }
    }
    return defaultDate;
};
exports.resolvePageDate = resolvePageDate;
//# sourceMappingURL=resolvePageDate.js.map